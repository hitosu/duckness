{"version":3,"file":"SagaDuck.js","names":["SagaDuck","duckName","appName","duckContext","reportError","refErrorReporter","current","addSaga","saga","sagas","push","spawn","call","duck","duckFace","poolName","rootSaga","all","Duck","console","error","Object","defineProperty","value","writable","enumerable","setErrorReporter","reporter"],"sources":["../src/SagaDuck.js"],"sourcesContent":["import Duck from '@duckness/duck'\nimport { spawn, call, all } from 'redux-saga/effects'\n\nexport default function SagaDuck(duckName, appName, duckContext) {\n  const duck = Duck(duckName, appName, duckContext)\n\n  const refErrorReporter = {\n    current: ('undefined' !== typeof console && console.error) || (() => {}) // eslint-disable-line no-console\n  }\n\n  function setErrorReporter(reporter) {\n    refErrorReporter.current = reporter\n  }\n\n  function reportError(...args) {\n    if ('function' === typeof refErrorReporter.current) {\n      refErrorReporter.current(...args)\n    }\n  }\n\n  const sagas = []\n  function addSaga(saga) {\n    sagas.push(\n      spawn(function* () {\n        while (true) {\n          try {\n            yield call(saga, duck.duckFace)\n            break\n          } catch (error) {\n            try {\n              error.poolName = duck.poolName\n              error.duckName = duck.duckName\n            } catch {\n              // skip\n            }\n            reportError(error, '@duckness/saga', duck.poolName, duck.duckName)\n          }\n        }\n      })\n    )\n  }\n\n  function* rootSaga() {\n    yield all(sagas)\n  }\n\n  Object.defineProperty(duck, 'saga', { value: addSaga, writable: false, enumerable: true })\n  Object.defineProperty(duck, 'rootSaga', { value: rootSaga, writable: false, enumerable: true })\n  Object.defineProperty(duck, 'setErrorReporter', { value: setErrorReporter, writable: false, enumerable: true })\n  Object.defineProperty(duck, 'reportError', { value: reportError, writable: false, enumerable: true })\n\n  return duck\n}\n"],"mappings":"oiOAGe,QAASA,SAAQ,CAACC,CAAQ,CAAEC,CAAO,CAAEC,CAAW,CAAE,CAW/D,QAASC,EAAW,EAAU,CACxB,UAAU,EAAK,MAAOC,EAAgB,CAACC,OAAO,EAChDD,CAAgB,CAACC,OAAO,OAAxBD,CAAgB,WAEpB,CAGA,QAASE,EAAO,CAACC,CAAI,CAAE,CACrBC,CAAK,CAACC,IAAI,CACR,GAAAC,cAAK,6BAAC,kGAGA,yBAAM,GAAAC,aAAI,EAACJ,CAAI,CAAEK,CAAI,CAACC,QAAQ,CAAC,uEAG/B,GAAI,CACF,KAAMC,QAAQ,CAAGF,CAAI,CAACE,QAAQ,CAC9B,KAAMd,QAAQ,CAAGY,CAAI,CAACZ,QACxB,CAAE,QAAM,CAER,CACAG,CAAW,MAAQ,gBAAgB,CAAES,CAAI,CAACE,QAAQ,CAAEF,CAAI,CAACZ,QAAQ,CAAC,6EAGvE,EAAC,CAEN,CAEA,QAAUe,EAAQ,wFAChB,gBAAM,GAAAC,YAAG,EAACR,CAAK,CAAC,wCACjB,iCAFSO,CAAQ,EAtCZH,CAAI,CAAG,GAAAK,aAAI,EAACjB,CAAQ,CAAEC,CAAO,CAAEC,CAAW,CAAC,CAE3CE,CAAgB,CAAG,CACvBC,OAAO,CAAG,WAAW,EAAK,MAAOa,QAAO,EAAIA,OAAO,CAACC,KAAK,EAAM,UAAM,CAAC,CACxE,CAAC,CAYKX,CAAK,CAAG,EAAE,CA+BhB,MALAY,OAAM,CAACC,cAAc,CAACT,CAAI,CAAE,MAAM,CAAE,CAAEU,KAAK,CAAEhB,CAAO,CAAEiB,QAAQ,GAAO,CAAEC,UAAU,GAAO,CAAC,CAAC,CAC1FJ,MAAM,CAACC,cAAc,CAACT,CAAI,CAAE,UAAU,CAAE,CAAEU,KAAK,CAAEP,CAAQ,CAAEQ,QAAQ,GAAO,CAAEC,UAAU,GAAO,CAAC,CAAC,CAC/FJ,MAAM,CAACC,cAAc,CAACT,CAAI,CAAE,kBAAkB,CAAE,CAAEU,KAAK,CAtCvD,QAASG,EAAgB,CAACC,CAAQ,CAAE,CAClCtB,CAAgB,CAACC,OAAO,CAAGqB,CAC7B,CAoCyE,CAAEH,QAAQ,GAAO,CAAEC,UAAU,GAAO,CAAC,CAAC,CAC/GJ,MAAM,CAACC,cAAc,CAACT,CAAI,CAAE,aAAa,CAAE,CAAEU,KAAK,CAAEnB,CAAW,CAAEoB,QAAQ,GAAO,CAAEC,UAAU,GAAO,CAAC,CAAC,CAE9FZ,CACT"}