"use strict";var _react=require("react");Object.defineProperty(exports,"__esModule",{value:!0}),exports.always=always,exports.default=createStore,exports.selectAll=selectAll,exports.whenChanged=whenChanged;function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_unsupportedIterableToArray(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _iterableToArrayLimit(a,b){var c=null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=c){var d,e,f,g,h=[],i=!0,j=!1;try{if(f=(c=c.call(a)).next,0===b){if(Object(c)!==c)return;i=!1}else for(;!(i=(d=f.call(c)).done)&&(h.push(d.value),h.length!==b);i=!0);}catch(a){j=!0,e=a}finally{try{if(!i&&null!=c.return&&(g=c.return(),Object(g)!==g))return}finally{if(j)throw e}}return h}}function _arrayWithHoles(a){if(Array.isArray(a))return a}function selectAll(a){return a}function always(){return!0}function whenChanged(c,a){return c!==a}function createStore(){function a(a){var b=a(h.current);return i.forEach(function(a){if(!a.shouldSelect||a.shouldSelect(b,h.current)){var c=a.selector?a.selector(b):b;(null==a.shouldUpdate||a.shouldUpdate(c,a.prevValue))&&(a(c),null!=a.shouldUpdate&&(a.prevValue=c))}}),h.current=b,h.current}function b(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},c=b.updateOnMount,d=b.updateOnUnmount,e=b.selector,f=b.shouldSelect,g=b.shouldUpdate,j=void 0===g?whenChanged:g,k=b.debounce,l=(0,_react.useState)(function(){return e(c?a(c):h.current)}),m=_slicedToArray(l,2),n=m[0],o=m[1],p=(0,_react.useRef)();p.current=k;var q=(0,_react.useRef)();return(0,_react.useEffect)(function(){var b=function(a){q.current&&clearTimeout(q.current),null==p.current?o(a):q.current=setTimeout(function(){q.current=null,o(a)},p.current)};return b.selector=e,b.shouldSelect=f,b.shouldUpdate=j,i.add(b),function(){d&&a(d),i.delete(b)}},[]),n}var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},d=c.initState,e=void 0===d?{}:d,f=c.actions,g=void 0===f?{}:f,h={current:e},i=new Set,j={};return Object.keys(g).forEach(function(b){j[b]=function(){for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];a(function(a){return g[b].apply(a,d)||a})}}),Object.freeze({useStore:b,Consumer:function(a){var c=b({updateOnMount:a.updateOnMount,updateOnUnmount:a.updateOnUnmount,selector:a.selector,shouldSelect:a.shouldSelect,shouldUpdate:a.shouldUpdate,debounce:a.debounce});return a.children(c)},actions:j,updateStore:a,getState:function(a){return a?a(h.current):h.current},subscribe:function(a){return i.add(a),function(){i.delete(a)}},destroy:function(){i.clear()}})}
//# sourceMappingURL=store.js.map