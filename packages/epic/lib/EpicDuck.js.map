{"version":3,"file":"EpicDuck.js","names":["EpicDuck","duckName","appName","duckContext","reportError","refErrorReporter","current","duck","Duck","console","error","epics","Object","defineProperty","value","epic","push","args","duckFace","pipe","rxCatchError","source","poolName","writable","enumerable","combineEpics","reporter"],"sources":["../src/EpicDuck.js"],"sourcesContent":["import Duck from '@duckness/duck'\nimport { combineEpics } from 'redux-observable'\nimport { catchError as rxCatchError } from 'rxjs/operators'\n\nexport default function EpicDuck(duckName, appName, duckContext) {\n  const duck = Duck(duckName, appName, duckContext)\n\n  const refErrorReporter = {\n    current: ('undefined' !== typeof console && console.error) || (() => {}) // eslint-disable-line no-console\n  }\n\n  function setErrorReporter(reporter) {\n    refErrorReporter.current = reporter\n  }\n\n  function reportError(...args) {\n    if ('function' === typeof refErrorReporter.current) {\n      refErrorReporter.current(...args)\n    }\n  }\n\n  const epics = []\n  function addEpic(epic) {\n    // add isolated epic\n    epics.push((...args) =>\n      epic(...args, duck.duckFace).pipe(\n        rxCatchError((error, source) => {\n          try {\n            error.poolName = duck.poolName\n            error.duckName = duck.duckName\n          } catch {\n            // skip\n          }\n          reportError(error, '@duckness/epic', duck.poolName, duck.duckName)\n          return source\n        })\n      )\n    )\n  }\n\n  function rootEpic() {\n    return combineEpics(...epics)\n  }\n\n  Object.defineProperty(duck, 'epic', { value: addEpic, writable: false, enumerable: true })\n  Object.defineProperty(duck, 'rootEpic', { value: rootEpic, writable: false, enumerable: true })\n  Object.defineProperty(duck, 'setErrorReporter', { value: setErrorReporter, writable: false, enumerable: true })\n  Object.defineProperty(duck, 'reportError', { value: reportError, writable: false, enumerable: true })\n\n  return duck\n}\n"],"mappings":"mTAIe,QAASA,SAAQ,CAACC,CAAQ,CAAEC,CAAO,CAAEC,CAAW,CAAE,CAW/D,QAASC,EAAW,EAAU,CACxB,UAAU,EAAK,MAAOC,EAAgB,CAACC,OAAO,EAChDD,CAAgB,CAACC,OAAO,OAAxBD,CAAgB,WAEpB,CAAC,GAdKE,EAAI,CAAG,GAAAC,aAAI,EAACP,CAAQ,CAAEC,CAAO,CAAEC,CAAW,CAAC,CAE3CE,CAAgB,CAAG,CACvBC,OAAO,CAAG,WAAW,EAAK,MAAOG,QAAO,EAAIA,OAAO,CAACC,KAAK,EAAM,UAAM,CAAC,CACxE,CAAC,CAYKC,CAAK,CAAG,EAAE,CA4BhB,MALAC,OAAM,CAACC,cAAc,CAACN,CAAI,CAAE,MAAM,CAAE,CAAEO,KAAK,CAtB3C,SAAiBC,CAAI,CAAE,CAErBJ,CAAK,CAACK,IAAI,CAAC,sCAAIC,CAAI,sBAAJA,CAAI,uBACjBF,EAAI,cAAIE,CAAI,SAAEV,CAAI,CAACW,QAAQ,GAAC,CAACC,IAAI,CAC/B,GAAAC,qBAAY,EAAC,SAACV,CAAK,CAAEW,CAAM,CAAK,CAC9B,GAAI,CACFX,CAAK,CAACY,QAAQ,CAAGf,CAAI,CAACe,QAAQ,CAC9BZ,CAAK,CAACT,QAAQ,CAAGM,CAAI,CAACN,QACxB,CAAE,QAAM,CAER,CAEA,MADAG,EAAW,CAACM,CAAK,CAAE,gBAAgB,CAAEH,CAAI,CAACe,QAAQ,CAAEf,CAAI,CAACN,QAAQ,CAAC,CAC3DoB,CACT,CAAC,CAAC,CACH,EAEL,CAMoD,CAAEE,QAAQ,GAAO,CAAEC,UAAU,GAAO,CAAC,CAAC,CAC1FZ,MAAM,CAACC,cAAc,CAACN,CAAI,CAAE,UAAU,CAAE,CAAEO,KAAK,CAL/C,UAAoB,CAClB,MAAOW,8BAAY,cAAId,CAAK,CAC9B,CAGyD,CAAEY,QAAQ,GAAO,CAAEC,UAAU,GAAO,CAAC,CAAC,CAC/FZ,MAAM,CAACC,cAAc,CAACN,CAAI,CAAE,kBAAkB,CAAE,CAAEO,KAAK,CAnCvD,SAA0BY,CAAQ,CAAE,CAClCrB,CAAgB,CAACC,OAAO,CAAGoB,CAC7B,CAiCyE,CAAEH,QAAQ,GAAO,CAAEC,UAAU,GAAO,CAAC,CAAC,CAC/GZ,MAAM,CAACC,cAAc,CAACN,CAAI,CAAE,aAAa,CAAE,CAAEO,KAAK,CAAEV,CAAW,CAAEmB,QAAQ,GAAO,CAAEC,UAAU,GAAO,CAAC,CAAC,CAE9FjB,CACT"}