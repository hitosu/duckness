{"version":3,"sources":["../src/useRedux.js"],"names":["useRedux","store","selector","shouldUpdate","shouldSelect","getState","selectedState","setSelectedState","customShouldSelect","refPrevStoreState","current","refPrevSelectedState","refSubscription","nextStoreState","nextSelectedState","unsubscribe","subscribe","useDispatchAction","actionCreator","payloadTransformer","payload","dispatch","useDispatch","dispatcher","deps","args"],"mappings":"aAAA,4B,+yDAae,QAASA,CAAAA,QAAT,CAAkBC,CAAlB,CAAyBC,CAAzB,CAAmCC,CAAnC,CAAiDC,CAAjD,CAA+D,OAClC,oBAAS,iBAAMF,CAAAA,CAAQ,CAACD,CAAK,CAACI,QAAN,EAAD,CAAd,CAAT,CADkC,uBACrEC,CADqE,MACtDC,CADsD,MAGtEC,CAAkB,CAAG,YAAe,MAAOJ,CAAAA,CAH2B,CAItEK,CAAiB,CAAG,kBAAO,IAAP,CAJkD,CAK5EA,CAAiB,CAACC,OAAlB,CAA4B,mBAAQ,iBAAOF,CAAAA,CAAkB,CAAGP,CAAK,CAACI,QAAN,EAAH,CAAsB,IAA/C,CAAR,CAA8D,CAACJ,CAAD,CAAQO,CAAR,CAA9D,CALgD,CAO5E,GAAMG,CAAAA,CAAoB,CAAG,kBAAO,IAAP,CAA7B,CACI,KAASR,CAR+D,GAS1EQ,CAAoB,CAACD,OAArB,CAA+BJ,CAT2C,EAY5E,GAAMM,CAAAA,CAAe,CAAG,kBAAO,IAAP,CAAxB,CAgCA,MA/BAA,CAAAA,CAAe,CAACF,OAAhB,CAA0B,uBACxB,SAAAG,CAAc,CAAI,CAChB,GAAI,CAACL,CAAD,EAAuBJ,CAAY,CAACS,CAAD,CAAiBJ,CAAiB,CAACC,OAAnC,CAAvC,CAAoF,CAClF,GAAMI,CAAAA,CAAiB,CAAGZ,CAAQ,CAACW,CAAD,CAAlC,CADkF,CAGhF,KAASV,CAAT,EACC,YAAe,MAAOA,CAAAA,CAAtB,EAAsCA,CAAY,CAACW,CAAD,CAAoBH,CAAoB,CAACD,OAAzC,CADnD,EAEAI,CAAiB,GAAKH,CAAoB,CAACD,OALqC,IAOhFH,CAAgB,CAACO,CAAD,CAPgE,CAQ5E,KAASX,CARmE,GAS9EQ,CAAoB,CAACD,OAArB,CAA+BI,CAT+C,EAYnF,CACGN,CAdY,GAedC,CAAiB,CAACC,OAAlB,CAA4BG,CAfd,CAiBjB,CAlBuB,CAmBxB,CAACX,CAAD,CAAWC,CAAX,CAAyBC,CAAzB,CAAuCI,CAAvC,CAnBwB,CA+B1B,CATA,qBAAU,UAAM,CACd,GAAMO,CAAAA,CAAW,CAAGd,CAAK,CAACe,SAAN,CAAgB,UAAM,CACxCJ,CAAe,CAACF,OAAhB,CAAwBT,CAAK,CAACI,QAAN,EAAxB,CACD,CAFmB,CAApB,CAGA,MAAO,WAAM,CACXU,CAAW,EACZ,CACF,CAPD,CAOG,CAACd,CAAD,CAPH,CASA,CAAOK,CACR,CAEM,QAASW,CAAAA,iBAAT,CAA2BhB,CAA3B,CAAkCiB,CAAlC,CAAiDC,CAAjD,CAAqE,CAC1E,MAAO,uBACL,SAAAC,CAAO,QACL,KAAK,EAAL,GAAWD,CAAX,CACIlB,CAAK,CAACoB,QAAN,CAAeH,CAAa,CAACE,CAAD,CAA5B,CADJ,CAEI,YAAe,MAAOD,CAAAA,CAAtB,CACAlB,CAAK,CAACoB,QAAN,CAAeH,CAAa,CAACC,CAAkB,CAACC,CAAD,CAAnB,CAA5B,CADA,CAEAnB,CAAK,CAACoB,QAAN,CAAeH,CAAa,CAACC,CAAD,CAA5B,CALC,CADF,CAOL,CAAClB,CAAD,CAAQiB,CAAR,CAAuBC,CAAvB,CAPK,CASR,CAEM,QAASG,CAAAA,WAAT,CAAqBrB,CAArB,CAA4BsB,CAA5B,CAAmD,IAAXC,CAAAA,CAAW,wDAAJ,EAAI,CACxD,MAAO,uBAAY,sCAAIC,CAAJ,sBAAIA,CAAJ,uBAAaF,CAAAA,CAAU,MAAV,SAAWtB,CAAK,CAACoB,QAAjB,SAA8BI,CAA9B,EAAb,CAAZ,EAA+DxB,CAA/D,4BAAyEuB,CAAzE,GACR","sourcesContent":["import { useState, useEffect, useMemo, useCallback, useRef } from 'react'\n\n/*\n * shouldUpdate:\n *   true - always update\n *   function - update if shouldUpdate(nextSelectedState, prevSelectedState)\n *   (default) - update if nextSelectedState !== prevSelectedState\n *\n * shouldSelect:\n *   function - select if shouldSelect(nextStoreState, prevStoreState)\n *   (default) - always select\n */\n\nexport default function useRedux(store, selector, shouldUpdate, shouldSelect) {\n  const [selectedState, setSelectedState] = useState(() => selector(store.getState()))\n\n  const customShouldSelect = 'function' === typeof shouldSelect\n  const refPrevStoreState = useRef(null)\n  refPrevStoreState.current = useMemo(() => (customShouldSelect ? store.getState() : null), [store, customShouldSelect])\n\n  const refPrevSelectedState = useRef(null)\n  if (true !== shouldUpdate) {\n    refPrevSelectedState.current = selectedState\n  }\n\n  const refSubscription = useRef(null)\n  refSubscription.current = useCallback(\n    nextStoreState => {\n      if (!customShouldSelect || shouldSelect(nextStoreState, refPrevStoreState.current)) {\n        const nextSelectedState = selector(nextStoreState)\n        if (\n          true === shouldUpdate ||\n          ('function' === typeof shouldUpdate && shouldUpdate(nextSelectedState, refPrevSelectedState.current)) ||\n          nextSelectedState !== refPrevSelectedState.current\n        ) {\n          setSelectedState(nextSelectedState)\n          if (true !== shouldUpdate) {\n            refPrevSelectedState.current = nextSelectedState\n          }\n        }\n      }\n      if (customShouldSelect) {\n        refPrevStoreState.current = nextStoreState\n      }\n    },\n    [selector, shouldUpdate, shouldSelect, customShouldSelect]\n  )\n\n  useEffect(() => {\n    const unsubscribe = store.subscribe(() => {\n      refSubscription.current(store.getState())\n    })\n    return () => {\n      unsubscribe()\n    }\n  }, [store])\n\n  return selectedState\n}\n\nexport function useDispatchAction(store, actionCreator, payloadTransformer) {\n  return useCallback(\n    payload =>\n      void 0 === payloadTransformer\n        ? store.dispatch(actionCreator(payload))\n        : 'function' === typeof payloadTransformer\n        ? store.dispatch(actionCreator(payloadTransformer(payload)))\n        : store.dispatch(actionCreator(payloadTransformer)),\n    [store, actionCreator, payloadTransformer]\n  )\n}\n\nexport function useDispatch(store, dispatcher, deps = []) {\n  return useCallback((...args) => dispatcher(store.dispatch, ...args), [store, ...deps])\n}\n"],"file":"useRedux.js"}